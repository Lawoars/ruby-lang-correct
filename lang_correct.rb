#encoding: UTF-8

#
# Оригинальный код (Original code):
# @link     http://code.google.com/p/php-lang-correct/
# @license  http://creativecommons.org/licenses/by-nc-sa/3.0/
# @author   Nasibullin Rinat
# @version  1.4.3
#


class LangCorrect
  #английский (all)
  EN = '[a-zA-Z]'.force_encoding('binary')

  #английский (uppercase)
  EN_UC = '[A-Z]'.force_encoding('binary')

  #английский + символы, которые м.б. набраны по ошибке в английской раскладке клавиатуры вместо русских букв (all)
  EN_SC = '[a-zA-Z\'`~<>,.:;{}\[\]"]'.force_encoding('binary')

  #символы, которые м.б. набраны по ошибке в английской раскладке клавиатуры вместо русских букв
  SC = '[\'`~<>,.:;{}\[\]"]'.force_encoding('binary')
  NO_SC = '[^\'`~<>,.:;{}\[\]"]'.force_encoding('binary')

  #русский + татарский (all)
  TT = "[\xd0-\xd3][\x80-\xbf](?<=\xd0[\x90-\xbf\x81]|\xd1[\x80-\x8f\x91]|\xd2[\x96\x97\xa2\xa3\xae\xaf\xba\xbb]|\xd3[\x98\x99\xa8\xa9])".force_encoding('binary')

  #русский + татарский (uppercase)
  TT_UC = "[\xd0\xd2\xd3][\x81-\xba](?<=\xd0[\x90-\xaf\x81]|\xd2[\x96\xa2\xae\xba]|\xd3[\x98\xa8])".force_encoding('binary')

  #русский + татарский (для фильтрованных текстов) (all)
  TT_F = "[\xd0-\xd3][\x80-\xbf]".force_encoding('binary')

  #гласная (vowel) (lowercase)
  VOWEL_LC = {tt: "\xd0[\xb0\xb5\xb8\xbe]|\xd1[\x83\x8b\x8d\x8e\x8f\x91]".force_encoding('binary'),
              en: '[aeiouy]'.force_encoding('binary')}

  #согласная (consonant) + графические знаки для русского языка (ъ, ь) (lowercase)
  CONSONANT_LC = {
      tt: "\xd0[\xb1-\xb4\xb6\xb7\xb9\xba-\xbd\xbf]|\xd1[\x80\x81\x82\x84-\x89\x8a\x8c]".force_encoding('binary'),
      en: '[bcdfghjklmnpqrstvwxz]'.force_encoding('binary')
  }

  WORDS_EXCEPTIONS = {
      tt: %w( трлн ющенко мебельград дэнис ),
      en: %w( heuer )
  }

  #русские буквы, похожие на англ. (uppercase)
  RU_SIMILAR_UC = "\xd0[\x90\x92\x95\x9a\x9c\x9d\x9e\xa0-\xa3\xa5]".force_encoding('binary')

  #русские буквы, похожие на англ. (all)
  RU_SIMILAR = "\xd0[\x90\x92\x95\x9a\x9c\x9d\x9e\xa0-\xa3\xa5\xb0\xb5\xbe]|\xd1[\x80\x81\x83\x85]".force_encoding('binary')

  #англ. буквы, похожие на русские (uppercase)
  EN_SIMILAR_UC = '[ABEKMHOPCTYX]'.force_encoding('binary')

  TT_UNIQ = "[\xd0\xd1][\x82-\xbf](?<=\xd0[\xb1-\xb4\xb6-\xbb\xbd\xbf\x81\x91-\x94\x96-\x99\x9b\x9f\xa4\xa6-\xaf]|\xd1[\x82\x84\x86-\x8f\x91])".force_encoding('binary')
  EN_UNIQ = "[\x42\x44\x46\x49\x4a\x4c\x4e\x51\x52\x53\x55\x57\x56\x5a\x62\x64\x66\x68\x69\x6a-\x6e\x71-\x77\x7a]".force_encoding('binary')

  TABLE = {
      #метод 0: таблица исправления ошибочно набранных букв, которые выглядят одинаково (русский <--> английский)
      similar_chars: {
          #lowercase          #UPPERCASE
          "а" => 'a',  "А" => 'A',
          "В" => 'B',
          "Е" => 'e',  "Е" => 'E',
          "К" => 'K',
          "М" => 'M',
          "Н" => 'H',
          "о" => 'o',  "О" => 'O',
          "р" => 'p',  "Р" => 'P',
          "с" => 'c',  "С" => 'C',
          "Т" => 'T',
          "у" => 'y',  "У" => 'Y',
          "х" => 'x',  "Х" => 'X',
      },
      keyboard_layout: {
          #CASE_UPPER         #case_lower
          "Ё" => '~',  "а" => '`', #Ё ё
          "А" => 'F',  "а" => 'f', #А а
          "Б" => '<',  "б" => ',', #Б б
          "В" => 'D',  "в" => 'd', #В в
          "Г" => 'U',  "г" => 'u', #Г г
          "Д" => 'L',  "д" => 'l', #Д д
          "Е" => 'T',  "е" => 't', #Е е
          "Ж" => ':',  "ж" => ';', #Ж ж
          "З" => 'P',  "з" => 'p', #З з
          "И" => 'B',  "и" => 'b', #И и
          "Й" => 'Q',  "й" => 'q', #Й й
          "К" => 'R',  "к" => 'r', #К к
          "Л" => 'K',  "л" => 'k', #Л л
          "М" => 'V',  "м" => 'v', #М м
          "Н" => 'Y',  "н" => 'y', #Н н
          "О" => 'J',  "о" => 'j', #О о
          "П" => 'G',  "п" => 'g', #П п
          #CASE_UPPER         #case_lower
          "Р" => 'H',  "р" => 'h', #Р р
          "С" => 'C',  "с" => 'c', #С с
          "Т" => 'N',  "т" => 'n', #Т т
          "У" => 'E',  "у" => 'e', #У у
          "Ф" => 'A',  "ф" => 'a', #Ф ф
          "Х" => '{',  "х" => '[', #Х х
          "Ц" => 'W',  "ц" => 'w', #Ц ц
          "Ч" => 'X',  "ч" => 'x', #Ч ч
          "Ш" => 'I',  "ш" => 'i', #Ш ш
          "Щ" => 'O',  "щ" => 'o', #Щ щ
          "Ь" => '}',  "ъ" => ']', #Ъ ъ
          "Ы" => 'S',  "ы" => 's', #Ы ы
          "ь" => 'M',  "ь" => 'm', #Ь ь
          "Э" => '"',  "э" => "'", #Э э
          "Ю" => '>',  "ю" => '.', #Ю ю
          "Я" => 'Z',  "я" => 'z', #Я я
      }
  }

  #несуществующие N-граммы для гласных букв
  VOWELS3_LC = {
      en: {
          'aea' => 0,
          'aei' => 1,
          'aeo' => 2,
          'aeu' => 3,
          'aia' => 4,
          'aie' => 5,
          'aii' => 6,
          'aoi' => 7,
          'aou' => 8,
          'aue' => 9,
          'aya' => 10,
          'aye' => 11,
          'ayi' => 12,
          'ayo' => 13,
          'ayu' => 14,
          'eae' => 15,
          'eau' => 16,
          'eea' => 17,
          'eei' => 18,
          'eeu' => 19,
          'eia' => 20,
          'eiu' => 21,
          'eoi' => 22,
          'eou' => 23,
          'eya' => 24,
          'eye' => 25,
          'eyi' => 26,
          'eyo' => 27,
          'iae' => 28,
          'iai' => 29,
          'iao' => 30,
          'iau' => 31,
          'iei' => 32,
          'ieu' => 33,
          'ioa' => 34,
          'ioe' => 35,
          'iou' => 36,
          'iya' => 37,
          'oae' => 38,
          'oea' => 39,
          'oei' => 40,
          'oeo' => 41,
          'oeu' => 42,
          'oey' => 43,
          'oia' => 44,
          'oie' => 45,
          'ooe' => 46,
          'ooi' => 47,
          'oou' => 48,
          'oua' => 49,
          'oue' => 50,
          'oui' => 51,
          'oya' => 52,
          'oye' => 53,
          'oyi' => 54,
          'oyo' => 55,
          'uae' => 56,
          'uai' => 57,
          'uay' => 58,
          'uea' => 59,
          'uee' => 60,
          'uei' => 61,
          'ueo' => 62,
          'ueu' => 63,
          'uey' => 64,
          'uia' => 65,
          'uie' => 66,
          'uio' => 67,
          'uiu' => 68,
          'uoa' => 69,
          'uoi' => 70,
          'uou' => 71,
          'uoy' => 72,
          'uya' => 73,
          'uye' => 74,
          'uyi' => 75,
          'yae' => 76,
          'yao' => 77,
          'yau' => 78,
          'yea' => 79,
          'yei' => 80,
          'yeo' => 81,
          'yey' => 82,
          'yie' => 83,
          'yoi' => 84,
          'you' => 85,
          'yoy' => 86,
          'yua' => 87,
      },
      tt: {
          'аау' => 0,
          'аео' => 1,
          'аеу' => 2,
          'аиа' => 3,
          'аио' => 4,
          'аиу' => 5,
          'аои' => 6,
          'ауэ' => 7,
          'аяя' => 8,
          'еаэ' => 9,
          'еее' => 10,
          'еео' => 11,
          'еоа' => 12,
          'еои' => 13,
          'еоо' => 14,
          'еую' => 15,
          'еуя' => 16,
          'еуё' => 17,
          'иау' => 18,
          'иео' => 19,
          'иие' => 20,
          'иоа' => 21,
          'иои' => 22,
          'иоу' => 23,
          'иоэ' => 24,
          'ияе' => 25,
          'ияи' => 26,
          'ияю' => 27,
          'оаэ' => 28,
          'оео' => 29,
          'оею' => 30,
          'оие' => 31,
          'оуе' => 32,
          'оуя' => 33,
          'оюе' => 34,
          'оюю' => 35,
          'ояе' => 36,
          'уео' => 37,
          'уюю' => 38,
      }
  }

  #несуществующие N-граммы для согласных букв
  CONSONANT4_LC = {
      en: {
          'bldg' => 0,
          'blvd' => 1,
          'bscr' => 2,
          'bstr' => 3,
          'cbcm' => 4,
          'cbft' => 5,
          'chfr' => 6,
          'chmn' => 7,
          'chsc' => 8,
          'chsh' => 9,
          'chst' => 10,
          'chth' => 11,
          'chts' => 12,
          'ckbr' => 13,
          'ckch' => 14,
          'ckcl' => 15,
          'ckdr' => 16,
          'ckgr' => 17,
          'cksc' => 18,
          'cksf' => 19,
          'cksh' => 20,
          'cksk' => 21,
          'cksl' => 22,
          'cksm' => 23,
          'cksn' => 24,
          'cksp' => 25,
          'ckst' => 26,
          'cksw' => 27,
          'ckth' => 28,
          'cktr' => 29,
          'ckwh' => 30,
          'cmps' => 31,
          'dspr' => 32,
          'dstr' => 33,
          'dthw' => 34,
          'ffsc' => 35,
          'ffsh' => 36,
          'ffsp' => 37,
          'fthl' => 38,
          'ftsm' => 39,
          'ftsp' => 40,
          'gdns' => 41,
          'ghbr' => 42,
          'ghfl' => 43,
          'ghsh' => 44,
          'ghtb' => 45,
          'ghtc' => 46,
          'ghtf' => 47,
          'ghth' => 48,
          'ghtj' => 49,
          'ghtl' => 50,
          'ghtm' => 51,
          'ghtn' => 52,
          'ghtr' => 53,
          'ghts' => 54,
          'ghtw' => 55,
          'hdbk' => 56,
          'hnst' => 57,
          'jctn' => 58,
          'khsh' => 59,
          'khst' => 60,
          'lchr' => 61,
          'ldpr' => 62,
          'ldsh' => 63,
          'ldsm' => 64,
          'ldsp' => 65,
          'ldst' => 66,
          'lfsk' => 67,
          'lfth' => 68,
          'lgth' => 69,
          'llfl' => 70,
          'llfr' => 71,
          'llph' => 72,
          'llpl' => 73,
          'llsh' => 74,
          'llsp' => 75,
          'llst' => 76,
          'lltr' => 77,
          'llwr' => 78,
          'lmcr' => 79,
          'lmsm' => 80,
          'lnrk' => 81,
          'lnsh' => 82,
          'lptr' => 83,
          'lsgr' => 84,
          'lshm' => 85,
          'lshw' => 86,
          'lstr' => 87,
          'lthf' => 88,
          'ltsf' => 89,
          'ltsh' => 90,
          'ltst' => 91,
          'mbsc' => 92,
          'mbsh' => 93,
          'mbsk' => 94,
          'mbst' => 95,
          'mddx' => 96,
          'mdnt' => 97,
          'mpbl' => 98,
          'mpgr' => 99,
          'mphl' => 100,
          'mphr' => 101,
          'mpsh' => 102,
          'mpst' => 103,
          'mptl' => 104,
          'mptn' => 105,
          'mptr' => 106,
          'mpts' => 107,
          'mscr' => 108,
          'mstr' => 109,
          'nchb' => 110,
          'nchl' => 111,
          'nchm' => 112,
          'nchn' => 113,
          'nchp' => 114,
          'nchr' => 115,
          'nchw' => 116,
          'nctl' => 117,
          'nctn' => 118,
          'ndbk' => 119,
          'ndbr' => 120,
          'ndch' => 121,
          'ndfl' => 122,
          'ndgl' => 123,
          'ndgr' => 124,
          'ndsc' => 125,
          'ndsh' => 126,
          'ndsl' => 127,
          'ndsm' => 128,
          'ndsp' => 129,
          'ndst' => 130,
          'ndsw' => 131,
          'ndth' => 132,
          'ndwr' => 133,
          'ngcr' => 134,
          'ngsg' => 135,
          'ngsh' => 136,
          'ngsm' => 137,
          'ngsp' => 138,
          'ngst' => 139,
          'ngth' => 140,
          'ngtz' => 141,
          'nksg' => 142,
          'nksh' => 143,
          'nksm' => 144,
          'nkst' => 145,
          'nsch' => 146,
          'nscr' => 147,
          'nsgr' => 148,
          'nshr' => 149,
          'nskr' => 150,
          'nspl' => 151,
          'nspr' => 152,
          'nssh' => 153,
          'nstr' => 154,
          'ntbr' => 155,
          'nthl' => 156,
          'nthr' => 157,
          'nths' => 158,
          'ntsh' => 159,
          'ntsm' => 160,
          'phth' => 161,
          'pstr' => 162,
          'pthr' => 163,
          'pths' => 164,
          'ptwr' => 165,
          'rbst' => 166,
          'rchb' => 167,
          'rchd' => 168,
          'rchl' => 169,
          'rchm' => 170,
          'rchn' => 171,
          'rchp' => 172,
          'rchw' => 173,
          'rdsh' => 174,
          'rdsm' => 175,
          'rdst' => 176,
          'rghs' => 177,
          'rkpl' => 178,
          'rksc' => 179,
          'rksh' => 180,
          'rksk' => 181,
          'rksm' => 182,
          'rksp' => 183,
          'rkst' => 184,
          'rldl' => 185,
          'rldw' => 186,
          'rlfr' => 187,
          'rmch' => 188,
          'rmst' => 189,
          'rmth' => 190,
          'rnbl' => 191,
          'rndl' => 192,
          'rnsk' => 193,
          'rnsp' => 194,
          'rnst' => 195,
          'rsch' => 196,
          'rscr' => 197,
          'rshl' => 198,
          'rshn' => 199,
          'rspr' => 200,
          'rstl' => 201,
          'rstr' => 202,
          'rsts' => 203,
          'rstw' => 204,
          'rtbr' => 205,
          'rtch' => 206,
          'rtcr' => 207,
          'rthb' => 208,
          'rthc' => 209,
          'rthd' => 210,
          'rthf' => 211,
          'rthl' => 212,
          'rthm' => 213,
          'rthq' => 214,
          'rthr' => 215,
          'rths' => 216,
          'rthw' => 217,
          'rtsh' => 218,
          'rtsm' => 219,
          'rtsp' => 220,
          'rtsw' => 221,
          'schl' => 222,
          'schm' => 223,
          'schn' => 224,
          'schw' => 225,
          'scrp' => 226,
          'sgmt' => 227,
          'shcl' => 228,
          'shkh' => 229,
          'shpr' => 230,
          'shpt' => 231,
          'shst' => 232,
          'shtr' => 233,
          'shwh' => 234,
          'smth' => 235,
          'ssrs' => 236,
          'ssst' => 237,
          'sstd' => 238,
          'sstr' => 239,
          'stcr' => 240,
          'sthm' => 241,
          'stpl' => 242,
          'stpr' => 243,
          'stsc' => 244,
          'stwr' => 245,
          'tblt' => 246,
          'tchb' => 247,
          'tchc' => 248,
          'tchd' => 249,
          'tchf' => 250,
          'tchl' => 251,
          'tchm' => 252,
          'tchp' => 253,
          'tchw' => 254,
          'thdr' => 255,
          'thsh' => 256,
          'thsk' => 257,
          'thsp' => 258,
          'thst' => 259,
          'tsch' => 260,
          'tspr' => 261,
          'tstr' => 262,
          'tthr' => 263,
          'ttsb' => 264,
          'tzkr' => 265,
          'whsl' => 266,
          'wnbr' => 267,
          'wnpl' => 268,
          'wnsf' => 269,
          'wnsh' => 270,
          'wnsm' => 271,
          'wnsp' => 272,
          'wnst' => 273,
          'wnsw' => 274,
          'wnth' => 275,
          'wntr' => 276,
          'wrnt' => 277,
          'wsfl' => 278,
          'wspr' => 279,
          'wstr' => 280,
          'xthl' => 281,
      },
      tt: {
          'блзд' => 0,
          'бльд' => 1,
          'брьс' => 2,
          'бств' => 3,
          'бстр' => 4,
          'взбл' => 5,
          'взбр' => 6,
          'взгл' => 7,
          'взгр' => 8,
          'вздв' => 9,
          'вздр' => 10,
          'врвг' => 11,
          'врск' => 12,
          'вскл' => 13,
          'вскр' => 14,
          'вспл' => 15,
          'вспр' => 16,
          'вств' => 17,
          'встр' => 18,
          'всхл' => 19,
          'всхр' => 20,
          'втск' => 21,
          'вхск' => 22,
          'грск' => 23,
          'гств' => 24,
          'гтст' => 25,
          'гшпр' => 26,
          'двзд' => 27,
          'джск' => 28,
          'дрст' => 29,
          'дскр' => 30,
          'дств' => 31,
          'дстр' => 32,
          'дтск' => 33,
          'жств' => 34,
          'звзд' => 35,
          'знст' => 36,
          'зтьс' => 37,
          'йздр' => 38,
          'йкбр' => 39,
          'йльн' => 40,
          'йншт' => 41,
          'йпфр' => 42,
          'йств' => 43,
          'йстр' => 44,
          'йтск' => 45,
          'йфст' => 46,
          'йхсв' => 47,
          'йхск' => 48,
          'йхср' => 49,
          'йхст' => 50,
          'кскл' => 51,
          'кскр' => 52,
          'кспл' => 53,
          'кспр' => 54,
          'кств' => 55,
          'кстн' => 56,
          'кстр' => 57,
          'лвст' => 58,
          'лжск' => 59,
          'лльн' => 60,
          'лльс' => 61,
          'лстр' => 62,
          'лсть' => 63,
          'льгв' => 64,
          'льдж' => 65,
          'льдк' => 66,
          'льдм' => 67,
          'льдс' => 68,
          'льдф' => 69,
          'льдц' => 70,
          'льдш' => 71,
          'льдъ' => 72,
          'льдь' => 73,
          'льзк' => 74,
          'льзн' => 75,
          'льзь' => 76,
          'лькл' => 77,
          'лькн' => 78,
          'льпн' => 79,
          'льпт' => 80,
          'льск' => 81,
          'льсн' => 82,
          'льст' => 83,
          'льтк' => 84,
          'льтм' => 85,
          'льтн' => 86,
          'льтп' => 87,
          'льтр' => 88,
          'льтс' => 89,
          'льтт' => 90,
          'льтф' => 91,
          'льфр' => 92,
          'льцг' => 93,
          'льчс' => 94,
          'льшб' => 95,
          'льшк' => 96,
          'льшн' => 97,
          'льшп' => 98,
          'льшф' => 99,
          'льшь' => 100,
          'мбль' => 101,
          'мбрс' => 102,
          'мвзв' => 103,
          'мздр' => 104,
          'мств' => 105,
          'мтск' => 106,
          'нгль' => 107,
          'нгст' => 108,
          'ндгр' => 109,
          'ндск' => 110,
          'ндсп' => 111,
          'ндшп' => 112,
          'ндшт' => 113,
          'нкск' => 114,
          'нктн' => 115,
          'нктс' => 116,
          'нсгр' => 117,
          'нскм' => 118,
          'нскр' => 119,
          'нспл' => 120,
          'нств' => 121,
          'нстк' => 122,
          'нстр' => 123,
          'нтгл' => 124,
          'нтль' => 125,
          'нтрб' => 126,
          'нтрв' => 127,
          'нтрг' => 128,
          'нтрд' => 129,
          'нтрм' => 130,
          'нтрн' => 131,
          'нтрп' => 132,
          'нтрр' => 133,
          'нтрф' => 134,
          'нтск' => 135,
          'нтст' => 136,
          'нфск' => 137,
          'нцкл' => 138,
          'нцпл' => 139,
          'нькн' => 140,
          'ньск' => 141,
          'ньчж' => 142,
          'псск' => 143,
          'пств' => 144,
          'птск' => 145,
          'рбск' => 146,
          'ргпр' => 147,
          'ргск' => 148,
          'ргфл' => 149,
          'рдск' => 150,
          'рдсм' => 151,
          'рдст' => 152,
          'рздр' => 153,
          'рзть' => 154,
          'ркгр' => 155,
          'ркск' => 156,
          'рктн' => 157,
          'рльс' => 158,
          'рмск' => 159,
          'рмтр' => 160,
          'рнск' => 161,
          'рпск' => 162,
          'рсдр' => 163,
          'рсск' => 164,
          'рств' => 165,
          'рстк' => 166,
          'рстн' => 167,
          'рстр' => 168,
          'рстс' => 169,
          'рсть' => 170,
          'ртвл' => 171,
          'ртвр' => 172,
          'ртгр' => 173,
          'рткр' => 174,
          'ртпл' => 175,
          'ртпр' => 176,
          'ртск' => 177,
          'ртсм' => 178,
          'ртшк' => 179,
          'ртьф' => 180,
          'рхзв' => 181,
          'рхпл' => 182,
          'рхпр' => 183,
          'рхсв' => 184,
          'рхск' => 185,
          'рхсм' => 186,
          'рхср' => 187,
          'рхтв' => 188,
          'рхшт' => 189,
          'рщвл' => 190,
          'рьмл' => 191,
          'скск' => 192,
          'спрь' => 193,
          'сспр' => 194,
          'ссср' => 195,
          'сств' => 196,
          'сстр' => 197,
          'ссшп' => 198,
          'ствл' => 199,
          'стрс' => 200,
          'стрш' => 201,
          'стск' => 202,
          'стьб' => 203,
          'стьд' => 204,
          'стьс' => 205,
          'ськн' => 206,
          'сьмн' => 207,
          'тмст' => 208,
          'тпрр' => 209,
          'трст' => 210,
          'тскр' => 211,
          'тств' => 212,
          'тстр' => 213,
          'ттль' => 214,
          'ттск' => 215,
          'тхск' => 216,
          'фств' => 217,
          'фстр' => 218,
          'хств' => 219,
          'хстр' => 220,
          'хткл' => 221,
          'хтск' => 222,
          'хтсм' => 223,
          'цстр' => 224,
      }
  }

  #несуществующие биграммы в начале и конце слов
  BIGRAMS = {
      #ru
      ' ёё' => 0,
      ' ёа' => 0,
      ' ёб' => 0,
      ' ёв' => 0,
      ' ёг' => 0,
      ' ёд' => 0,
      ' ёе' => 0,
      ' ёз' => 0,
      ' ёи' => 0,
      ' ёй' => 0,
      ' ён' => 0,
      ' ёо' => 0,
      ' ёп' => 0,
      ' ёс' => 0,
      ' ёт' => 0,
      ' ёу' => 0,
      ' ёф' => 0,
      ' ёц' => 0,
      ' ёч' => 0,
      ' ёщ' => 0,
      ' ёъ' => 0,
      ' ёы' => 0,
      ' ёь' => 0,
      ' ёэ' => 0,
      ' ёю' => 0,
      ' ёя' => 0,
      ' аё' => 0,
      ' аа' => 0,
      ' ае' => 0,
      ' ач' => 0,
      ' аъ' => 0,
      ' аы' => 0,
      ' аь' => 0,
      ' аю' => 0,
      ' ая' => 0,
      ' бб' => 0,
      ' бв' => 0,
      ' бг' => 0,
      ' бж' => 0,
      ' бй' => 0,
      ' бк' => 0,
      ' бм' => 0,
      ' бн' => 0,
      ' бп' => 0,
      ' бс' => 0,
      ' бт' => 0,
      ' бф' => 0,
      ' бх' => 0,
      ' бц' => 0,
      ' бч' => 0,
      ' бш' => 0,
      ' бщ' => 0,
      ' бъ' => 0,
      ' вй' => 0,
      ' вф' => 0,
      ' вщ' => 0,
      ' вэ' => 0,
      ' вю' => 0,
      ' гё' => 0,
      ' гб' => 0,
      ' гз' => 0,
      ' гй' => 0,
      ' гк' => 0,
      ' гп' => 0,
      ' гс' => 0,
      ' гт' => 0,
      ' гф' => 0,
      ' гх' => 0,
      ' гц' => 0,
      ' гч' => 0,
      ' гш' => 0,
      ' гщ' => 0,
      ' гъ' => 0,
      ' гь' => 0,
      ' гэ' => 0,
      ' дб' => 0,
      ' дг' => 0,
      ' дд' => 0,
      ' дй' => 0,
      ' дк' => 0,
      ' дп' => 0,
      ' дс' => 0,
      ' дт' => 0,
      ' дф' => 0,
      ' дх' => 0,
      ' дц' => 0,
      ' дч' => 0,
      ' дш' => 0,
      ' дъ' => 0,
      ' дэ' => 0,
      ' еа' => 0,
      ' еб' => 0,
      ' еи' => 0,
      ' ео' => 0,
      ' ет' => 0,
      ' еу' => 0,
      ' ец' => 0,
      #' еш' => 0,
      ' еъ' => 0,
      ' еы' => 0,
      ' еь' => 0,
      ' еэ' => 0,
      ' ея' => 0,
      ' жз' => 0,
      ' жй' => 0,
      ' жк' => 0,
      ' жл' => 0,
      ' жп' => 0,
      ' жс' => 0,
      ' жт' => 0,
      ' жф' => 0,
      ' жх' => 0,
      ' жц' => 0,
      ' жч' => 0,
      ' жш' => 0,
      ' жщ' => 0,
      ' жъ' => 0,
      ' жы' => 0,
      ' жь' => 0,
      ' жэ' => 0,
      #' жю' => 0,
      ' жя' => 0,
      ' зб' => 0,
      ' зж' => 0,
      ' зз' => 0,
      ' зй' => 0,
      ' зк' => 0,
      ' зп' => 0,
      ' зс' => 0,
      ' зт' => 0,
      ' зф' => 0,
      ' зх' => 0,
      ' зц' => 0,
      ' зч' => 0,
      ' зш' => 0,
      ' зщ' => 0,
      ' зъ' => 0,
      ' зь' => 0,
      ' зэ' => 0,
      ' иё' => 0,
      ' иа' => 0,
      ' иф' => 0,
      ' иц' => 0,
      ' иъ' => 0,
      ' иы' => 0,
      ' иь' => 0,
      ' иэ' => 0,
      ' ия' => 0,
      ' йё' => 0,
      ' йа' => 0,
      ' йб' => 0,
      ' йв' => 0,
      ' йг' => 0,
      ' йд' => 0,
      ' йж' => 0,
      ' йз' => 0,
      ' йи' => 0,
      ' йй' => 0,
      ' йк' => 0,
      ' йл' => 0,
      ' йм' => 0,
      ' йн' => 0,
      ' йп' => 0,
      ' йр' => 0,
      ' йс' => 0,
      ' йт' => 0,
      ' йу' => 0,
      ' йф' => 0,
      ' йх' => 0,
      ' йц' => 0,
      ' йч' => 0,
      ' йш' => 0,
      ' йщ' => 0,
      ' йъ' => 0,
      ' йы' => 0,
      ' йь' => 0,
      ' йэ' => 0,
      ' йю' => 0,
      ' йя' => 0,
      ' кё' => 0,
      ' кб' => 0,
      ' кд' => 0,
      ' кж' => 0,
      ' кй' => 0,
      ' кк' => 0,
      ' кф' => 0,
      ' кц' => 0,
      ' кч' => 0,
      ' кщ' => 0,
      ' къ' => 0,
      ' кя' => 0,
      ' лв' => 0,
      ' лд' => 0,
      ' лз' => 0,
      ' лй' => 0,
      ' лк' => 0,
      ' лл' => 0,
      ' лм' => 0,
      ' лн' => 0,
      ' лп' => 0,
      ' лр' => 0,
      ' лс' => 0,
      ' лт' => 0,
      ' лф' => 0,
      ' лх' => 0,
      ' лц' => 0,
      ' лч' => 0,
      ' лш' => 0,
      ' лщ' => 0,
      ' лъ' => 0,
      ' лэ' => 0,
      ' мб' => 0,
      ' мв' => 0,
      ' мд' => 0,
      ' мж' => 0,
      ' мй' => 0,
      ' мк' => 0,
      ' мп' => 0,
      ' мт' => 0,
      ' мф' => 0,
      ' мц' => 0,
      ' мъ' => 0,
      ' мь' => 0,
      ' нб' => 0,
      ' нв' => 0,
      ' нг' => 0,
      ' нд' => 0,
      ' нж' => 0,
      ' нз' => 0,
      ' нй' => 0,
      ' нк' => 0,
      ' нл' => 0,
      ' нм' => 0,
      ' нн' => 0,
      ' нп' => 0,
      ' нс' => 0,
      ' нт' => 0,
      ' нф' => 0,
      ' нх' => 0,
      ' нц' => 0,
      ' нч' => 0,
      ' нш' => 0,
      ' нщ' => 0,
      ' нъ' => 0,
      ' оё' => 0,
      ' ои' => 0,
      ' оу' => 0,
      ' оъ' => 0,
      ' оы' => 0,
      ' оь' => 0,
      ' оэ' => 0,
      ' оя' => 0,
      ' пб' => 0,
      ' пв' => 0,
      ' пг' => 0,
      ' пд' => 0,
      ' пж' => 0,
      ' пз' => 0,
      ' пй' => 0,
      ' пк' => 0,
      ' пм' => 0,
      ' пп' => 0,
      ' пц' => 0,
      ' пщ' => 0,
      ' пъ' => 0,
      ' рб' => 0,
      ' рг' => 0,
      ' рз' => 0,
      ' рй' => 0,
      ' рк' => 0,
      ' рл' => 0,
      ' рм' => 0,
      ' рн' => 0,
      ' рп' => 0,
      ' рр' => 0,
      ' рф' => 0,
      ' рх' => 0,
      ' рч' => 0,
      ' рш' => 0,
      ' рщ' => 0,
      ' ръ' => 0,
      ' сй' => 0,
      ' сщ' => 0,
      ' тб' => 0,
      ' тг' => 0,
      ' тд' => 0,
      ' тж' => 0,
      ' тз' => 0,
      ' тй' => 0,
      ' тн' => 0,
      ' тт' => 0,
      ' тх' => 0,
      ' тц' => 0,
      ' тч' => 0,
      ' тш' => 0,
      ' тъ' => 0,
      ' уу' => 0,
      ' уъ' => 0,
      ' уы' => 0,
      ' уь' => 0,
      ' фб' => 0,
      ' фв' => 0,
      ' фг' => 0,
      ' фд' => 0,
      ' фж' => 0,
      ' фз' => 0,
      ' фй' => 0,
      ' фк' => 0,
      ' фм' => 0,
      ' фн' => 0,
      ' фп' => 0,
      ' фс' => 0,
      ' фх' => 0,
      ' фц' => 0,
      ' фч' => 0,
      ' фш' => 0,
      ' фщ' => 0,
      ' фъ' => 0,
      ' фэ' => 0,
      ' фя' => 0,
      ' хё' => 0,
      ' хб' => 0,
      ' хг' => 0,
      ' хд' => 0,
      ' хж' => 0,
      ' хз' => 0,
      ' хй' => 0,
      ' хк' => 0,
      ' хп' => 0,
      ' хс' => 0,
      ' хт' => 0,
      ' хф' => 0,
      ' хц' => 0,
      ' хч' => 0,
      ' хш' => 0,
      ' хщ' => 0,
      ' хъ' => 0,
      ' хы' => 0,
      ' хь' => 0,
      #' хэ' => 0,
      ' хю' => 0,
      ' хя' => 0,
      ' цё' => 0,
      ' цб' => 0,
      ' цг' => 0,
      ' цд' => 0,
      ' цж' => 0,
      ' цй' => 0,
      ' цл' => 0,
      ' цм' => 0,
      ' цн' => 0,
      ' цп' => 0,
      ' цр' => 0,
      ' цс' => 0,
      ' цт' => 0,
      ' цф' => 0,
      ' цх' => 0,
      ' цц' => 0,
      ' цч' => 0,
      ' цш' => 0,
      ' цщ' => 0,
      ' цъ' => 0,
      ' ць' => 0,
      ' цэ' => 0,
      ' цю' => 0,
      ' ця' => 0,
      ' чб' => 0,
      ' чг' => 0,
      ' чд' => 0,
      ' чж' => 0,
      ' чз' => 0,
      ' чй' => 0,
      ' чн' => 0,
      ' чп' => 0,
      ' чс' => 0,
      ' чф' => 0,
      ' чц' => 0,
      ' чч' => 0,
      ' чщ' => 0,
      ' чъ' => 0,
      ' чы' => 0,
      ' чэ' => 0,
      ' чю' => 0,
      ' чя' => 0,
      ' шб' => 0,
      ' шг' => 0,
      ' шд' => 0,
      ' шж' => 0,
      ' шз' => 0,
      ' шй' => 0,
      ' шс' => 0,
      ' шф' => 0,
      ' шц' => 0,
      ' шч' => 0,
      ' шщ' => 0,
      ' шъ' => 0,
      ' шы' => 0,
      ' шэ' => 0,
      ' шю' => 0,
      ' шя' => 0,
      ' щб' => 0,
      ' щв' => 0,
      ' щг' => 0,
      ' щд' => 0,
      ' щж' => 0,
      ' щз' => 0,
      ' щй' => 0,
      ' щк' => 0,
      ' щл' => 0,
      ' щм' => 0,
      ' щн' => 0,
      ' що' => 0,
      ' щп' => 0,
      ' щр' => 0,
      ' щс' => 0,
      ' щт' => 0,
      ' щф' => 0,
      ' щх' => 0,
      ' щц' => 0,
      ' щч' => 0,
      ' щш' => 0,
      ' щщ' => 0,
      ' щъ' => 0,
      ' щы' => 0,
      ' щь' => 0,
      ' щэ' => 0,
      ' щю' => 0,
      ' щя' => 0,
      ' ъё' => 0,
      ' ъа' => 0,
      ' ъб' => 0,
      ' ъв' => 0,
      ' ъг' => 0,
      ' ъд' => 0,
      ' ъе' => 0,
      ' ъж' => 0,
      ' ъз' => 0,
      ' ъи' => 0,
      ' ъй' => 0,
      ' ък' => 0,
      ' ъл' => 0,
      ' ъм' => 0,
      ' ън' => 0,
      ' ъо' => 0,
      ' ъп' => 0,
      ' ър' => 0,
      ' ъс' => 0,
      ' ът' => 0,
      ' ъу' => 0,
      ' ъф' => 0,
      ' ъх' => 0,
      ' ъц' => 0,
      ' ъч' => 0,
      ' ъш' => 0,
      ' ъщ' => 0,
      ' ъъ' => 0,
      ' ъы' => 0,
      ' ъь' => 0,
      ' ъэ' => 0,
      ' ъю' => 0,
      ' ъя' => 0,
      ' ыё' => 0,
      ' ыа' => 0,
      ' ыб' => 0,
      ' ыв' => 0,
      ' ыг' => 0,
      ' ыд' => 0,
      ' ые' => 0,
      ' ыж' => 0,
      ' ыз' => 0,
      ' ыи' => 0,
      ' ый' => 0,
      ' ык' => 0,
      ' ыл' => 0,
      ' ын' => 0,
      ' ыо' => 0,
      ' ып' => 0,
      ' ыр' => 0,
      ' ыс' => 0,
      ' ыт' => 0,
      ' ыу' => 0,
      ' ыф' => 0,
      ' ых' => 0,
      ' ыц' => 0,
      ' ыч' => 0,
      ' ыш' => 0,
      ' ыщ' => 0,
      ' ыъ' => 0,
      ' ыы' => 0,
      ' ыь' => 0,
      ' ыэ' => 0,
      ' ыю' => 0,
      ' ыя' => 0,
      ' ьё' => 0,
      ' ьа' => 0,
      ' ьб' => 0,
      ' ьв' => 0,
      ' ьг' => 0,
      ' ьд' => 0,
      ' ье' => 0,
      ' ьж' => 0,
      ' ьз' => 0,
      ' ьи' => 0,
      ' ьй' => 0,
      ' ьк' => 0,
      ' ьл' => 0,
      ' ьм' => 0,
      ' ьн' => 0,
      ' ьо' => 0,
      ' ьп' => 0,
      ' ьр' => 0,
      ' ьс' => 0,
      ' ьт' => 0,
      ' ьу' => 0,
      ' ьф' => 0,
      ' ьх' => 0,
      ' ьц' => 0,
      ' ьч' => 0,
      ' ьш' => 0,
      ' ьщ' => 0,
      ' ьъ' => 0,
      ' ьы' => 0,
      ' ьь' => 0,
      ' ьэ' => 0,
      ' ью' => 0,
      ' ья' => 0,
      ' эё' => 0,
      ' эа' => 0,
      ' эе' => 0,
      ' эи' => 0,
      ' эц' => 0,
      ' эч' => 0,
      ' эщ' => 0,
      ' эъ' => 0,
      ' эы' => 0,
      ' эь' => 0,
      ' ээ' => 0,
      ' эю' => 0,
      ' юё' => 0,
      ' юе' => 0,
      ' юи' => 0,
      ' юй' => 0,
      ' юо' => 0,
      ' юу' => 0,
      ' юц' => 0,
      ' юш' => 0,
      ' ющ' => 0,
      ' юъ' => 0,
      ' юы' => 0,
      ' юь' => 0,
      ' юэ' => 0,
      ' юя' => 0,
      ' яё' => 0,
      ' яа' => 0,
      ' яе' => 0,
      ' яж' => 0,
      ' яо' => 0,
      ' яу' => 0,
      ' яф' => 0,
      ' яц' => 0,
      ' яъ' => 0,
      ' яы' => 0,
      ' яь' => 0,
      ' яэ' => 0,
      ' яю' => 0,
      ' яя' => 0,
      'ёё' => 0,
      'ёё ' => 0,
      'ёа' => 0,
      'ёа ' => 0,
      'ёг ' => 0,
      'ёе' => 0,
      'ёе ' => 0,
      'ёи' => 0,
      'ёи ' => 0,
      'ёй' => 0,
      'ёо' => 0,
      'ёо ' => 0,
      'ёу' => 0,
      'ёу ' => 0,
      'ёф' => 0,
      'ёф ' => 0,
      'ёц ' => 0,
      'ёч ' => 0,
      'ёщ ' => 0,
      'ёъ' => 0,
      'ёъ ' => 0,
      'ёы' => 0,
      'ёы ' => 0,
      'ёь' => 0,
      'ёь ' => 0,
      'ёэ' => 0,
      'ёэ ' => 0,
      'ёю' => 0,
      'ёя' => 0,
      'ёя ' => 0,
      'аё ' => 0,
      'аа ' => 0,
      'аъ' => 0,
      'аъ ' => 0,
      'аы' => 0,
      'аы ' => 0,
      'аь' => 0,
      'аь ' => 0,
      'аэ ' => 0,
      'бё ' => 0,
      'бб ' => 0,
      'бв ' => 0,
      'бг ' => 0,
      'бд ' => 0,
      'бж ' => 0,
      'бз ' => 0,
      'бй' => 0,
      'бй ' => 0,
      'бк ' => 0,
      'бм ' => 0,
      'бн ' => 0,
      'бп ' => 0,
      'бт ' => 0,
      'бф ' => 0,
      'бх ' => 0,
      'бц ' => 0,
      'бч ' => 0,
      'бш ' => 0,
      'бщ ' => 0,
      'бъ ' => 0,
      'бэ ' => 0,
      'вё ' => 0,
      'вб ' => 0,
      'вв ' => 0,
      'вд ' => 0,
      'вж' => 0,
      'вж ' => 0,
      'вз ' => 0,
      'вй' => 0,
      'вй ' => 0,
      'вл ' => 0,
      'вп ' => 0,
      'вф ' => 0,
      'вц ' => 0,
      'вч ' => 0,
      'вщ ' => 0,
      'въ' => 0,
      'въ ' => 0,
      'вэ ' => 0,
      'гё' => 0,
      'гё ' => 0,
      'гб ' => 0,
      'гг ' => 0,
      'гж' => 0,
      'гж ' => 0,
      'гз ' => 0,
      'гй' => 0,
      'гй ' => 0,
      'гк ' => 0,
      'гн ' => 0,
      'гп ' => 0,
      'гф ' => 0,
      'гх' => 0,
      'гх ' => 0,
      'гц' => 0,
      'гц ' => 0,
      'гч ' => 0,
      'гш ' => 0,
      'гщ ' => 0,
      'гъ' => 0,
      'гъ ' => 0,
      'гы ' => 0,
      'гь' => 0,
      'гь ' => 0,
      'гэ ' => 0,
      'гю' => 0,
      'гю ' => 0,
      'гя' => 0,
      'гя ' => 0,
      'дё ' => 0,
      'дб ' => 0,
      'дг ' => 0,
      'дд ' => 0,
      'дй' => 0,
      'дй ' => 0,
      'дк ' => 0,
      'дм ' => 0,
      'дн ' => 0,
      'дп ' => 0,
      'дс ' => 0,
      'дф ' => 0,
      'дх ' => 0,
      'дц ' => 0,
      'дч ' => 0,
      'дш ' => 0,
      'дщ ' => 0,
      'дъ ' => 0,
      'еа ' => 0,
      'еу ' => 0,
      'еъ' => 0,
      'еъ ' => 0,
      'еы' => 0,
      'еы ' => 0,
      'еь' => 0,
      'еь ' => 0,
      'еэ ' => 0,
      'жё ' => 0,
      'жв ' => 0,
      'жг ' => 0,
      'жж ' => 0,
      'жз ' => 0,
      'жй' => 0,
      'жй ' => 0,
      'жк ' => 0,
      'жл ' => 0,
      'жн ' => 0,
      'жп ' => 0,
      'жр ' => 0,
      'жс ' => 0,
      'жт ' => 0,
      'жф ' => 0,
      'жх ' => 0,
      'жц ' => 0,
      'жч ' => 0,
      'жш' => 0,
      'жш ' => 0,
      'жщ' => 0,
      'жщ ' => 0,
      'жъ' => 0,
      'жъ ' => 0,
      'жы ' => 0,
      'жэ ' => 0,
      'жю' => 0,
      'жю ' => 0,
      'жя' => 0,
      'жя ' => 0,
      'зё ' => 0,
      'зж ' => 0,
      'зз ' => 0,
      'зй' => 0,
      'зй ' => 0,
      'зк ' => 0,
      'зп ' => 0,
      'зр ' => 0,
      'зс ' => 0,
      'зт ' => 0,
      'зф' => 0,
      'зф ' => 0,
      'зх' => 0,
      'зх ' => 0,
      'зц ' => 0,
      'зч ' => 0,
      'зш ' => 0,
      'зщ' => 0,
      'зщ ' => 0,
      'зъ ' => 0,
      'зэ ' => 0,
      'иъ' => 0,
      'иъ ' => 0,
      'иы' => 0,
      'иы ' => 0,
      'иь' => 0,
      'иь ' => 0,
      'иэ ' => 0,
      'йё' => 0,
      'йё ' => 0,
      'йа ' => 0,
      'йв ' => 0,
      'йг ' => 0,
      'йж' => 0,
      'йж ' => 0,
      'йз ' => 0,
      'йи ' => 0,
      'йй' => 0,
      'йй ' => 0,
      'йо ' => 0,
      'йу' => 0,
      'йу ' => 0,
      'йч ' => 0,
      'йш ' => 0,
      'йщ ' => 0,
      'йъ' => 0,
      'йъ ' => 0,
      'йы' => 0,
      'йы ' => 0,
      'йь' => 0,
      'йь ' => 0,
      'йэ' => 0,
      'йэ ' => 0,
      'йю' => 0,
      'йю ' => 0,
      'йя' => 0,
      'кё ' => 0,
      'кб ' => 0,
      'кг ' => 0,
      'кд ' => 0,
      'кж ' => 0,
      'кз ' => 0,
      'кй' => 0,
      'кй ' => 0,
      'км ' => 0,
      'кн ' => 0,
      'кф ' => 0,
      'кц ' => 0,
      'кч ' => 0,
      'кш ' => 0,
      'кщ' => 0,
      'кщ ' => 0,
      'къ' => 0,
      'къ ' => 0,
      'кы ' => 0,
      'кь ' => 0,
      'кэ' => 0,
      'кэ ' => 0,
      'кя' => 0,
      'кя ' => 0,
      'лв ' => 0,
      'лж ' => 0,
      'лз ' => 0,
      'лй' => 0,
      'лй ' => 0,
      'лр ' => 0,
      'лф ' => 0,
      'лх ' => 0,
      'лц ' => 0,
      'лч ' => 0,
      'лш ' => 0,
      'лщ ' => 0,
      'лъ' => 0,
      'лъ ' => 0,
      'лэ' => 0,
      'лэ ' => 0,
      'мё ' => 0,
      'мв ' => 0,
      'мг ' => 0,
      'мд ' => 0,
      'мз ' => 0,
      'мй' => 0,
      'мк ' => 0,
      'мл ' => 0,
      'мр ' => 0,
      'мх ' => 0,
      'мц ' => 0,
      'мч ' => 0,
      'мш ' => 0,
      'мщ ' => 0,
      'мъ' => 0,
      'мъ ' => 0,
      'мэ ' => 0,
      'мю ' => 0,
      'нё ' => 0,
      'нб ' => 0,
      'нв ' => 0,
      'нй' => 0,
      'нл ' => 0,
      'нп ' => 0,
      'нщ ' => 0,
      'нъ ' => 0,
      'нэ ' => 0,
      'оъ' => 0,
      'оъ ' => 0,
      'оы' => 0,
      'оы ' => 0,
      'оь' => 0,
      'оь ' => 0,
      'пё ' => 0,
      'пб ' => 0,
      'пв' => 0,
      'пв ' => 0,
      'пг' => 0,
      'пг ' => 0,
      'пд ' => 0,
      'пж' => 0,
      'пж ' => 0,
      'пз' => 0,
      'пз ' => 0,
      'пй' => 0,
      'пй ' => 0,
      'пк ' => 0,
      'пл ' => 0,
      'пм ' => 0,
      'пн ' => 0,
      'пф ' => 0,
      'пх ' => 0,
      'пц ' => 0,
      'пч ' => 0,
      'пш ' => 0,
      'пщ ' => 0,
      'пъ' => 0,
      'пъ ' => 0,
      'пэ' => 0,
      'пэ ' => 0,
      'пю ' => 0,
      'рё ' => 0,
      'рй' => 0,
      'рй ' => 0,
      'ръ' => 0,
      'ръ ' => 0,
      'рэ ' => 0,
      'сб ' => 0,
      'св ' => 0,
      'сг ' => 0,
      'сд ' => 0,
      'сж ' => 0,
      'сз' => 0,
      'сз ' => 0,
      'сй' => 0,
      'сй ' => 0,
      'сн ' => 0,
      'сп ' => 0,
      'сф ' => 0,
      'сц ' => 0,
      'сч ' => 0,
      'сш ' => 0,
      'сщ ' => 0,
      'съ ' => 0,
      'сэ ' => 0,
      'тб ' => 0,
      'тг ' => 0,
      'тд ' => 0,
      'тж ' => 0,
      'тз ' => 0,
      'тй' => 0,
      'тй ' => 0,
      'тк ' => 0,
      'тл ' => 0,
      'тп ' => 0,
      'тф ' => 0,
      'тх ' => 0,
      'тц ' => 0,
      'тш ' => 0,
      'тщ ' => 0,
      'тъ ' => 0,
      'уё ' => 0,
      'уо ' => 0,
      'уу ' => 0,
      'уц ' => 0,
      'уъ' => 0,
      'уъ ' => 0,
      'уы' => 0,
      'уы ' => 0,
      'уь' => 0,
      'уь ' => 0,
      'уэ ' => 0,
      'фё ' => 0,
      'фб ' => 0,
      'фв ' => 0,
      'фг ' => 0,
      'фд ' => 0,
      'фж' => 0,
      'фж ' => 0,
      'фз' => 0,
      'фз ' => 0,
      'фй' => 0,
      'фй ' => 0,
      'фк ' => 0,
      'фл ' => 0,
      'фн ' => 0,
      'фп' => 0,
      'фп ' => 0,
      'фс ' => 0,
      'фх' => 0,
      'фх ' => 0,
      'фц' => 0,
      'фц ' => 0,
      'фч ' => 0,
      'фш ' => 0,
      'фщ ' => 0,
      'фъ' => 0,
      'фъ ' => 0,
      'фэ' => 0,
      'фэ ' => 0,
      'фю ' => 0,
      'хё' => 0,
      'хё ' => 0,
      'хб ' => 0,
      'хг ' => 0,
      'хд ' => 0,
      'хж ' => 0,
      'хз ' => 0,
      'хй' => 0,
      'хй ' => 0,
      'хк ' => 0,
      'хн ' => 0,
      'хп ' => 0,
      'хр ' => 0,
      'хс ' => 0,
      'хф ' => 0,
      'хх ' => 0,
      'хц ' => 0,
      'хч ' => 0,
      'хш ' => 0,
      'хщ' => 0,
      'хщ ' => 0,
      'хъ ' => 0,
      'хы' => 0,
      'хы ' => 0,
      'хь' => 0,
      'хь ' => 0,
      'хэ ' => 0,
      'хю' => 0,
      'хю ' => 0,
      'хя' => 0,
      'хя ' => 0,
      'цё' => 0,
      'цё ' => 0,
      'цб' => 0,
      'цб ' => 0,
      'цв ' => 0,
      'цг ' => 0,
      'цд ' => 0,
      'цж' => 0,
      'цж ' => 0,
      'цз ' => 0,
      'цй' => 0,
      'цй ' => 0,
      'цк ' => 0,
      'цл ' => 0,
      'цм ' => 0,
      'цн ' => 0,
      'цп ' => 0,
      'цр ' => 0,
      'цс ' => 0,
      'цт ' => 0,
      'цф' => 0,
      'цф ' => 0,
      'цх' => 0,
      'цх ' => 0,
      'цц ' => 0,
      'цч' => 0,
      'цч ' => 0,
      'цш ' => 0,
      'цщ' => 0,
      'цщ ' => 0,
      'цъ' => 0,
      'цъ ' => 0,
      'ць' => 0,
      'ць ' => 0,
      'цэ' => 0,
      'цэ ' => 0,
      'цю' => 0,
      'цю ' => 0,
      'ця' => 0,
      'ця ' => 0,
      'чё ' => 0,
      'чб ' => 0,
      'чг' => 0,
      'чг ' => 0,
      'чд' => 0,
      'чд ' => 0,
      'чж ' => 0,
      'чз' => 0,
      'чз ' => 0,
      'чй' => 0,
      'чй ' => 0,
      'чк ' => 0,
      'чл ' => 0,
      'чм ' => 0,
      'чн ' => 0,
      'чп' => 0,
      'чп ' => 0,
      'чр ' => 0,
      'чс ' => 0,
      'чф' => 0,
      'чф ' => 0,
      'чх ' => 0,
      'чц ' => 0,
      'чч ' => 0,
      'чш ' => 0,
      'чщ' => 0,
      'чщ ' => 0,
      'чъ' => 0,
      'чъ ' => 0,
      'чы' => 0,
      'чы ' => 0,
      'чэ' => 0,
      'чэ ' => 0,
      'чю' => 0,
      'чю ' => 0,
      'чя' => 0,
      'чя ' => 0,
      'шё ' => 0,
      'шб ' => 0,
      'шг ' => 0,
      'шд' => 0,
      'шд ' => 0,
      'шж' => 0,
      'шж ' => 0,
      'шз' => 0,
      'шз ' => 0,
      'шй' => 0,
      'шй ' => 0,
      'шк ' => 0,
      'шл ' => 0,
      'шм ' => 0,
      'шн ' => 0,
      'шп ' => 0,
      'шр ' => 0,
      'шс ' => 0,
      'шф ' => 0,
      'шх' => 0,
      'шх ' => 0,
      'шч ' => 0,
      'шш' => 0,
      'шш ' => 0,
      'шщ' => 0,
      'шщ ' => 0,
      'шъ' => 0,
      'шъ ' => 0,
      'шы' => 0,
      'шы ' => 0,
      'шэ' => 0,
      'шэ ' => 0,
      'шя' => 0,
      'шя ' => 0,
      'щб' => 0,
      'щб ' => 0,
      'щв ' => 0,
      'щг' => 0,
      'щг ' => 0,
      'щд' => 0,
      'щд ' => 0,
      'щж' => 0,
      'щж ' => 0,
      'щз' => 0,
      'щз ' => 0,
      'щй' => 0,
      'щй ' => 0,
      'щк' => 0,
      'щк ' => 0,
      'щл' => 0,
      'щл ' => 0,
      'щм ' => 0,
      'щн ' => 0,
      'щп' => 0,
      'щп ' => 0,
      'щр ' => 0,
      'щс' => 0,
      'щс ' => 0,
      'щт' => 0,
      'щт ' => 0,
      'щф' => 0,
      'щф ' => 0,
      'щх' => 0,
      'щх ' => 0,
      'щц' => 0,
      'щц ' => 0,
      'щч' => 0,
      'щч ' => 0,
      'щш' => 0,
      'щш ' => 0,
      'щщ' => 0,
      'щщ ' => 0,
      'щъ' => 0,
      'щъ ' => 0,
      'щы' => 0,
      'щы ' => 0,
      'щэ' => 0,
      'щэ ' => 0,
      'щю' => 0,
      'щю ' => 0,
      'щя' => 0,
      'щя ' => 0,
      'ъё ' => 0,
      'ъа' => 0,
      'ъа ' => 0,
      'ъб' => 0,
      'ъб ' => 0,
      'ъв' => 0,
      'ъв ' => 0,
      'ъг' => 0,
      'ъг ' => 0,
      'ъд' => 0,
      'ъд ' => 0,
      'ъе ' => 0,
      'ъж' => 0,
      'ъж ' => 0,
      'ъз' => 0,
      'ъз ' => 0,
      'ъи' => 0,
      'ъи ' => 0,
      'ъй' => 0,
      'ъй ' => 0,
      'ък' => 0,
      'ък ' => 0,
      'ъл' => 0,
      'ъл ' => 0,
      'ъм' => 0,
      'ъм ' => 0,
      'ън' => 0,
      'ън ' => 0,
      'ъо' => 0,
      'ъо ' => 0,
      'ъп' => 0,
      'ъп ' => 0,
      'ър' => 0,
      'ър ' => 0,
      'ъс' => 0,
      'ъс ' => 0,
      'ът' => 0,
      'ът ' => 0,
      'ъу' => 0,
      'ъу ' => 0,
      'ъф' => 0,
      'ъф ' => 0,
      'ъх' => 0,
      'ъх ' => 0,
      'ъц' => 0,
      'ъц ' => 0,
      'ъч' => 0,
      'ъч ' => 0,
      'ъш' => 0,
      'ъш ' => 0,
      'ъщ' => 0,
      'ъщ ' => 0,
      'ъъ' => 0,
      'ъъ ' => 0,
      'ъы' => 0,
      'ъы ' => 0,
      'ъь' => 0,
      'ъь ' => 0,
      'ъэ' => 0,
      'ъэ ' => 0,
      'ъю ' => 0,
      'ъя ' => 0,
      'ыё' => 0,
      'ыё ' => 0,
      'ыа' => 0,
      'ыа ' => 0,
      'ыи ' => 0,
      'ыо ' => 0,
      'ыу ' => 0,
      'ыф ' => 0,
      'ыъ' => 0,
      'ыъ ' => 0,
      'ыы' => 0,
      'ыы ' => 0,
      'ыь' => 0,
      'ыь ' => 0,
      'ыэ' => 0,
      'ыэ ' => 0,
      'ыю ' => 0,
      'ьа' => 0,
      'ьа ' => 0,
      'ьв ' => 0,
      'ьг ' => 0,
      'ьж ' => 0,
      'ьз ' => 0,
      'ьй' => 0,
      'ьй ' => 0,
      'ьл ' => 0,
      'ьн ' => 0,
      'ьр ' => 0,
      'ьу' => 0,
      'ьу ' => 0,
      'ьх ' => 0,
      'ьщ ' => 0,
      'ьъ' => 0,
      'ьъ ' => 0,
      'ьы ' => 0,
      'ьь' => 0,
      'ьь ' => 0,
      'ьэ ' => 0,
      'эё' => 0,
      'эё ' => 0,
      'эа' => 0,
      'эа ' => 0,
      'эб' => 0,
      'эб ' => 0,
      'эв ' => 0,
      'эг ' => 0,
      'эд ' => 0,
      'эе' => 0,
      'эе ' => 0,
      'эж' => 0,
      'эж ' => 0,
      'эз ' => 0,
      'эи ' => 0,
      'эй ' => 0,
      'эл ' => 0,
      'эм ' => 0,
      'эн ' => 0,
      'эо' => 0,
      'эо ' => 0,
      'эу' => 0,
      'эу ' => 0,
      'эф ' => 0,
      'эх ' => 0,
      'эц' => 0,
      'эц ' => 0,
      'эч' => 0,
      'эч ' => 0,
      'эш ' => 0,
      'эщ' => 0,
      'эщ ' => 0,
      'эъ' => 0,
      'эъ ' => 0,
      'эы' => 0,
      'эы ' => 0,
      'эь' => 0,
      'эь ' => 0,
      'ээ ' => 0,
      'эю' => 0,
      'эю ' => 0,
      'эя' => 0,
      'эя ' => 0,
      'юё' => 0,
      'юё ' => 0,
      'юа ' => 0,
      'юе ' => 0,
      'юж ' => 0,
      'юи ' => 0,
      'юл ' => 0,
      'юо ' => 0,
      'юу' => 0,
      'юу ' => 0,
      'юц ' => 0,
      'юъ' => 0,
      'юъ ' => 0,
      'юы' => 0,
      'юы ' => 0,
      'юь' => 0,
      'юь ' => 0,
      'юэ ' => 0,
      'юя' => 0,
      'яё' => 0,
      'яё ' => 0,
      'яа' => 0,
      'яа ' => 0,
      'яе ' => 0,
      'яо ' => 0,
      'яф' => 0,
      'яф ' => 0,
      'яъ' => 0,
      'яъ ' => 0,
      'яы' => 0,
      'яы ' => 0,
      'яь' => 0,
      'яь ' => 0,
      'яэ' => 0,
      'яэ ' => 0,
      #en
      ' \'f' => 0,
      ' \'p' => 0,
      ' \'q' => 0,
      ' \'r' => 0,
      ' \'x' => 0,
      ' \'y' => 0,
      ' \'z' => 0,
      ' bj' => 0,
      ' bq' => 0,
      ' bz' => 0,
      ' c\'' => 0,
      ' cq' => 0,
      ' cv' => 0,
      ' cx' => 0,
      ' dq' => 0,
      ' dx' => 0,
      ' ez' => 0,
      ' f\'' => 0,
      ' fh' => 0,
      ' fk' => 0,
      ' fq' => 0,
      ' fv' => 0,
      ' fw' => 0,
      ' fz' => 0,
      ' g\'' => 0,
      ' gf' => 0,
      ' gg' => 0,
      ' gj' => 0,
      ' gv' => 0,
      ' gx' => 0,
      ' gz' => 0,
      ' h\'' => 0,
      ' hj' => 0,
      ' hk' => 0,
      ' hn' => 0,
      ' hq' => 0,
      ' hx' => 0,
      ' iq' => 0,
      ' iw' => 0,
      ' iy' => 0,
      ' jb' => 0,
      ' jf' => 0,
      ' jh' => 0,
      ' jj' => 0,
      ' jk' => 0,
      ' jl' => 0,
      ' jm' => 0,
      ' jq' => 0,
      ' jw' => 0,
      ' jx' => 0,
      ' jy' => 0,
      ' jz' => 0,
      ' k\'' => 0,
      ' kf' => 0,
      ' kj' => 0,
      ' kq' => 0,
      ' kt' => 0,
      ' kx' => 0,
      ' kz' => 0,
      ' lj' => 0,
      ' lk' => 0,
      ' lq' => 0,
      ' lv' => 0,
      ' mj' => 0,
      ' mq' => 0,
      ' mz' => 0,
      ' nj' => 0,
      ' nk' => 0,
      ' nq' => 0,
      ' nz' => 0,
      ' oq' => 0,
      ' pj' => 0,
      ' pz' => 0,
      ' qb' => 0,
      ' qe' => 0,
      ' qf' => 0,
      ' qg' => 0,
      ' qh' => 0,
      ' qj' => 0,
      ' qk' => 0,
      ' qo' => 0,
      ' qp' => 0,
      ' qs' => 0,
      ' qv' => 0,
      ' qx' => 0,
      ' qy' => 0,
      ' qz' => 0,
      ' rb' => 0,
      ' rk' => 0,
      ' rq' => 0,
      ' rv' => 0,
      ' rx' => 0,
      ' rz' => 0,
      ' sz' => 0,
      ' tf' => 0,
      ' tg' => 0,
      ' tj' => 0,
      ' tq' => 0,
      ' u\'' => 0,
      ' ue' => 0,
      ' uj' => 0,
      ' uo' => 0,
      ' uq' => 0,
      ' uu' => 0,
      ' uy' => 0,
      ' vb' => 0,
      ' vj' => 0,
      ' vk' => 0,
      ' vn' => 0,
      ' vq' => 0,
      ' vr' => 0,
      ' vv' => 0,
      ' vw' => 0,
      ' vx' => 0,
      ' vy' => 0,
      ' vz' => 0,
      ' wj' => 0,
      ' wl' => 0,
      ' wn' => 0,
      ' wq' => 0,
      ' wx' => 0,
      ' wz' => 0,
      ' xb' => 0,
      ' xf' => 0,
      ' xg' => 0,
      ' xh' => 0,
      ' xj' => 0,
      ' xk' => 0,
      ' xq' => 0,
      ' xt' => 0,
      ' xu' => 0,
      ' xz' => 0,
      ' yf' => 0,
      ' yg' => 0,
      ' yh' => 0,
      ' yj' => 0,
      ' yk' => 0,
      ' yl' => 0,
      ' yn' => 0,
      ' yq' => 0,
      ' yv' => 0,
      ' yx' => 0,
      ' yy' => 0,
      ' yz' => 0,
      ' z\'' => 0,
      ' zb' => 0,
      ' zc' => 0,
      ' zd' => 0,
      ' zf' => 0,
      ' zg' => 0,
      ' zh' => 0,
      ' zj' => 0,
      ' zk' => 0,
      ' zl' => 0,
      ' zm' => 0,
      ' zq' => 0,
      ' zr' => 0,
      ' zv' => 0,
      ' zw' => 0,
      ' zx' => 0,
      ' zz' => 0,
      '\'a ' => 0,
      '\'b' => 0,
      '\'b ' => 0,
      '\'c ' => 0,
      '\'f' => 0,
      '\'f ' => 0,
      '\'g' => 0,
      '\'g ' => 0,
      '\'h ' => 0,
      '\'i ' => 0,
      '\'j' => 0,
      '\'j ' => 0,
      '\'k' => 0,
      '\'k ' => 0,
      '\'l ' => 0,
      '\'n ' => 0,
      '\'o ' => 0,
      '\'p ' => 0,
      '\'q' => 0,
      '\'q ' => 0,
      '\'r ' => 0,
      '\'u' => 0,
      '\'u ' => 0,
      '\'v ' => 0,
      '\'w ' => 0,
      '\'x' => 0,
      '\'x ' => 0,
      '\'z' => 0,
      '\'z ' => 0,
      'b\' ' => 0,
      'bg ' => 0,
      'bh ' => 0,
      'bp ' => 0,
      'bq' => 0,
      'bq ' => 0,
      'bv ' => 0,
      'bx' => 0,
      'bz' => 0,
      'bz ' => 0,
      'c\' ' => 0,
      'cf ' => 0,
      'cj' => 0,
      'cn ' => 0,
      'cq ' => 0,
      'cv' => 0,
      'cw' => 0,
      'cx' => 0,
      'cx ' => 0,
      'cz ' => 0,
      'db ' => 0,
      'dj ' => 0,
      'dk ' => 0,
      'dw ' => 0,
      'dx' => 0,
      'eh ' => 0,
      'ej ' => 0,
      'f\' ' => 0,
      'fg ' => 0,
      'fh ' => 0,
      'fj' => 0,
      'fj ' => 0,
      'fk' => 0,
      'fk ' => 0,
      'fq' => 0,
      'fq ' => 0,
      'fv ' => 0,
      'fw ' => 0,
      'fx' => 0,
      'fx ' => 0,
      'fz' => 0,
      'fz ' => 0,
      'g\' ' => 0,
      'gc ' => 0,
      'gf ' => 0,
      'gj ' => 0,
      'gk ' => 0,
      'gl ' => 0,
      'gq' => 0,
      'gq ' => 0,
      'gv' => 0,
      'gv ' => 0,
      'gw ' => 0,
      'gx' => 0,
      'gx ' => 0,
      'gz ' => 0,
      'hb ' => 0,
      'hc ' => 0,
      'hg ' => 0,
      'hh ' => 0,
      'hj' => 0,
      'hj ' => 0,
      'hk ' => 0,
      'hv' => 0,
      'hv ' => 0,
      'hw ' => 0,
      'hx' => 0,
      'hx ' => 0,
      'hz' => 0,
      'i\' ' => 0,
      'ih ' => 0,
      'iq ' => 0,
      'iw ' => 0,
      'j\'' => 0,
      'j\' ' => 0,
      'jb' => 0,
      'jb ' => 0,
      'jc' => 0,
      'jc ' => 0,
      'jd' => 0,
      'jf' => 0,
      'jg' => 0,
      'jg ' => 0,
      'jh' => 0,
      'jh ' => 0,
      'jj' => 0,
      'jj ' => 0,
      'jk ' => 0,
      'jl ' => 0,
      'jm' => 0,
      'jm ' => 0,
      'jn' => 0,
      'jn ' => 0,
      'jp ' => 0,
      'jq' => 0,
      'jq ' => 0,
      'jr' => 0,
      'jr ' => 0,
      'js' => 0,
      'js ' => 0,
      'jt' => 0,
      'ju ' => 0,
      'jv' => 0,
      'jv ' => 0,
      'jw' => 0,
      'jw ' => 0,
      'jx' => 0,
      'jx ' => 0,
      'jy' => 0,
      'jy ' => 0,
      'jz' => 0,
      'jz ' => 0,
      'kb ' => 0,
      'kc ' => 0,
      'kd ' => 0,
      'kj ' => 0,
      'km ' => 0,
      'kp ' => 0,
      'kq' => 0,
      'kq ' => 0,
      'kv' => 0,
      'kv ' => 0,
      'kx' => 0,
      'kx ' => 0,
      'kz' => 0,
      'kz ' => 0,
      'lg ' => 0,
      'lh ' => 0,
      'lj ' => 0,
      'lq ' => 0,
      'lr ' => 0,
      'lv ' => 0,
      'lw ' => 0,
      'lx' => 0,
      'lz ' => 0,
      'm\' ' => 0,
      'mg ' => 0,
      'mh ' => 0,
      'mj ' => 0,
      'mk ' => 0,
      'mq' => 0,
      'mq ' => 0,
      'mx' => 0,
      'mx ' => 0,
      'mz' => 0,
      'nb ' => 0,
      'nm ' => 0,
      'pj ' => 0,
      'pk ' => 0,
      'pq' => 0,
      'pq ' => 0,
      'pv' => 0,
      'pw ' => 0,
      'px' => 0,
      'px ' => 0,
      'pz ' => 0,
      'q\'' => 0,
      'q\' ' => 0,
      'qa ' => 0,
      'qb' => 0,
      'qb ' => 0,
      'qc' => 0,
      'qc ' => 0,
      'qd' => 0,
      'qd ' => 0,
      'qe' => 0,
      'qe ' => 0,
      'qf' => 0,
      'qf ' => 0,
      'qg' => 0,
      'qg ' => 0,
      'qh' => 0,
      'qh ' => 0,
      'qi' => 0,
      'qj' => 0,
      'qj ' => 0,
      'qk' => 0,
      'qk ' => 0,
      'ql' => 0,
      'ql ' => 0,
      'qm' => 0,
      'qm ' => 0,
      'qn' => 0,
      'qn ' => 0,
      'qo' => 0,
      'qo ' => 0,
      'qp' => 0,
      'qp ' => 0,
      'qq' => 0,
      'qq ' => 0,
      'qr' => 0,
      'qs' => 0,
      'qs ' => 0,
      'qt' => 0,
      'qt ' => 0,
      'qu ' => 0,
      'qv' => 0,
      'qv ' => 0,
      'qw' => 0,
      'qw ' => 0,
      'qx' => 0,
      'qx ' => 0,
      'qy' => 0,
      'qy ' => 0,
      'qz' => 0,
      'qz ' => 0,
      'rq ' => 0,
      'rz ' => 0,
      'sg ' => 0,
      'sj ' => 0,
      'sx' => 0,
      'sx ' => 0,
      'sz' => 0,
      'sz ' => 0,
      'tg ' => 0,
      'tj ' => 0,
      'tq' => 0,
      'tq ' => 0,
      'tx' => 0,
      'tx ' => 0,
      'uj ' => 0,
      'uq ' => 0,
      'uu ' => 0,
      'uw ' => 0,
      'v\' ' => 0,
      'vb' => 0,
      'vb ' => 0,
      'vc' => 0,
      'vf' => 0,
      'vf ' => 0,
      'vg' => 0,
      'vh' => 0,
      'vh ' => 0,
      'vj' => 0,
      'vj ' => 0,
      'vk' => 0,
      'vk ' => 0,
      'vl ' => 0,
      'vm' => 0,
      'vn ' => 0,
      'vp' => 0,
      'vp ' => 0,
      'vq' => 0,
      'vq ' => 0,
      'vr ' => 0,
      'vv ' => 0,
      'vw' => 0,
      'vw ' => 0,
      'vx' => 0,
      'vz' => 0,
      'vz ' => 0,
      'w\' ' => 0,
      'wb ' => 0,
      'wc ' => 0,
      'wf ' => 0,
      'wg ' => 0,
      'wj' => 0,
      'wj ' => 0,
      'wq' => 0,
      'wq ' => 0,
      'wr ' => 0,
      'wv' => 0,
      'wv ' => 0,
      'wx' => 0,
      'wz ' => 0,
      'x\'' => 0,
      'x\' ' => 0,
      'xa ' => 0,
      'xb ' => 0,
      'xc ' => 0,
      'xd' => 0,
      'xd ' => 0,
      'xf ' => 0,
      'xg ' => 0,
      'xh ' => 0,
      'xj' => 0,
      'xj ' => 0,
      'xk' => 0,
      'xk ' => 0,
      'xl ' => 0,
      'xm ' => 0,
      'xn' => 0,
      'xn ' => 0,
      'xp ' => 0,
      'xq ' => 0,
      'xr' => 0,
      'xr ' => 0,
      'xs ' => 0,
      'xu ' => 0,
      'xv' => 0,
      'xv ' => 0,
      'xw ' => 0,
      'xx' => 0,
      'xz' => 0,
      'xz ' => 0,
      'yb ' => 0,
      'yc ' => 0,
      'yd ' => 0,
      'yf ' => 0,
      'yg ' => 0,
      'yh ' => 0,
      'yj ' => 0,
      'yq' => 0,
      'yq ' => 0,
      'yu ' => 0,
      'yv ' => 0,
      'yw ' => 0,
      'yy' => 0,
      'yy ' => 0,
      'yz ' => 0,
      'z\'' => 0,
      'z\' ' => 0,
      'zb ' => 0,
      'zc' => 0,
      'zc ' => 0,
      'zd' => 0,
      'zd ' => 0,
      'zf' => 0,
      'zf ' => 0,
      'zg ' => 0,
      'zh' => 0,
      'zh ' => 0,
      'zj' => 0,
      'zj ' => 0,
      'zk ' => 0,
      'zl ' => 0,
      'zn' => 0,
      'zn ' => 0,
      'zp ' => 0,
      'zq' => 0,
      'zq ' => 0,
      'zr' => 0,
      'zr ' => 0,
      'zs' => 0,
      'zs ' => 0,
      'zt' => 0,
      'zt ' => 0,
      'zu ' => 0,
      'zv ' => 0,
      'zw ' => 0,
      'zx' => 0,
      'zx ' => 0
  }

  def initialize words_exceptions = {}
    #русский --> английский:
    @en_correct = /(?:(?:#{TT_F})(?:(?:#{EN_UNIQ})|(?:#{EN_SC}){2})|(?:#{EN_SC})(?:#{TT_F})(?:#{EN_SC})|(?:(?:#{EN_UNIQ})|(?:#{EN_SC}){2})(?:#{TT_F}))/

    #английский --> русский:
    @tt_correct = /(?:(?:#{EN_SC})(?:(?:#{TT_UNIQ})|(?:#{TT_F}){2})|(?:#{TT_F})(?:#{EN_SC})(?:#{TT_F})|(?:(?:#{TT_UNIQ})|(?:#{TT_F}){2})(?:#{EN_SC}))/

    @table_flip = {
        similar_chars: TABLE[:similar_chars].invert,
        keyboard_layout: TABLE[:keyboard_layout].invert
    }

    @words_exceptions = WORDS_EXCEPTIONS.merge(words_exceptions)
  end

  def parse(text, mode = :similar_chars)
    @words = {}
    return [text, words] unless text.is_a? String

    @mode = mode
    #вырезаем и заменяем некоторые символы
    additional_chars = [
        "\xc2\xad".force_encoding('binary'),  #"мягкие" переносы строк (&shy;)
    ];

    #http://ru.wikipedia.org/wiki/Диакритические_знаки
    #text = text.force_encoding('binary').gsub(/[^x00-\x7F]/n, '').to_s

    s = _parse1(text.force_encoding('binary')).force_encoding('UTF-8')

    [s, @words]
  end

  private
  def chk_mode(m)
    @mode.is_a?(Array) ? @mode.include?(m) : @mode == m
  end

  def strtr(str, replace_pairs)
    keys = replace_pairs.map {|a, b| a.dup.force_encoding('binary') }
    values = replace_pairs.map {|a, b| b.dup.force_encoding('binary') }
    rgx = /(#{keys.map{|a| Regexp.quote(a) }.join( ')|(' )})/
    str.gsub(rgx) { |match| values[keys.index(match)] }
  end

  def _parse1(text)
    rgx = Regexp.new(/(?> (#{EN})|(#{TT})|(#{SC})){3,}+/sx)
    text.gsub(rgx) {|w| _word(w.match(rgx))}
  end

  def _word(m)
    suggestions = {}
    #если найдено слово из мешанины русских и латинских букв
    word = m[0]
    if(m[1] && m[2])
      return word unless(chk_mode(:similar_chars))
      #ВНИМАНИЕ! порядок следования правил преобразования имеет значение!

      #Исправляем ошибочно набранные буквы, которые выглядят одинаково
      #в инициалах перед фамилиями (русский <--> английский), например: Т.С.Навка

      #0a. английский --> русский:
      rgx = /^(#{EN_SIMILAR_UC}\.(?:#{EN_SIMILAR_UC}\.)?)(#{NO_SC}{2,}+)$/
      if(word[1] == '.' && (matches = word.match(rgx)) )
        sword = _parse1(matches[2])
        rgx = /^(?:#{TT_UC})(?:#{TT_F}){1,}$/
        if sword.match(rgx)
          return strtr(matches[1], @table_flip[:similar_chars]).force_encoding('binary') + sword
        end
      end

      #0b. русский --> английский:
      rgx = /^(#{RU_SIMILAR_UC}\.(?:#{RU_SIMILAR_UC}\.)?)(#{NO_SC}{2,}+)$/
      if(word[2] == '.' && (matches = word.match(rgx)) )
        sword = _parse1(matches[2])
        rgx = /^(?:#{EN_UC})(?:#{EN}){1,}$/
        if sword.match(rgx)
          return strtr(matches[1], TABLE[:similar_chars]).force_encoding('binary') + sword
        end
      end

      #1. английский --> русский:
      s = _replace(word, @tt_correct, :similar_chars, true)
      suggestions[:tt0] = s if word != s && !is_mixed(s)

      #2. английский --> русский:
      s = _replace(word, @tt_correct, :keyboard_layout, true)
      suggestions[:tt1] = s if word != s

      #3. русский --> английский:
      s = _replace(word, @en_correct, :similar_chars, false)
      suggestions[:en0] = s if word != s && !is_mixed(s)

      #4. русский --> английский:
      s = _replace(word, @en_correct, :keyboard_layout, false)
      suggestions[:en1] = s if word != s

    #если найдено слово только из латинских букв; минимальная длина -- 4 буквы!
    elsif(m[1] && word.size >= 4)
      return word unless chk_mode(:keyboard_layout)
      #не обрабатываем аббревиатуры, пример: AMPAS
      return word if word.match(/^(?:#{EN_UC}|#{SC}){1,6}+$/)

      #английский --> русский:
      suggestions[:en1] = word
      suggestions[:tt1] = strtr(word, @table_flip[:keyboard_layout])
    #если найдено слово только из русских букв; минимальная длина -- 4 буквы!
    elsif(m[2] && word.size >= 8)
      return word unless chk_mode(:keyboard_layout)
      #не обрабатываем аббревиатуры, пример: ДОСААФ
      return word if word.match(/^(?:#{TT_UC}|#{SC}){1,6}+$/)

      #русский --> английский:
      suggestions[:tt1] = word
      suggestions[:en1] = strtr(word, TABLE[:keyboard_layout])
    #найдены спецсимволы или длина слова слишком мала
    else
      return word
    end

    if(suggestions.empty?)
      s = word
    else
      s = _detect(word, suggestions, !m[3])
    end

    if( s != word)
      @words[word] = s
    end

    s

  end


  def _replace(word, rgx, method, flip)
    sword = word.dup
    begin
      spword = sword
      sword = spword.gsub(rgx) do |s|
        strtr(s, flip ? @table_flip[method] : TABLE[method])
      end
    end while(sword != spword)
    sword
  end

  def is_mixed(word)
    word.match(/(?:#{EN})/) && word.match(/(?:#{TT_F})/)
  end


  def _detect(word, suggestions, is_sc)
    #не д. б. несуществующих N-грамм
    suggestions.each do |type, w|
      lang = type.to_s[0..1]
      suggestions.delete(type) if _bigram_exists(w, lang.to_sym)
    end


    return word if suggestions.empty?

    s = suggestions[suggestions.keys.last]

    #если в $word были спецсимволы, а в $s их уже нет, возвращаем $s
    return s if(is_sc && !s.match(/#{SC}/))

    #если в $s спецсимволов больше чем букв, возвращаем $word
    sc_count = s.scan(/#{SC}/).size
    return word if sc_count > 0 && sc_count > (s.force_encoding('UTF-8').size - sc_count)

    suggestions[suggestions.keys.first]
  end


  #анализ на основе N-грамм русского и английского языка
  def _bigram_exists(word, lang)


    word8 = word.dup.force_encoding('UTF-8').downcase
    length = word8.size

    #шаг 0.
    #проверяем слова в списке слов-исключений
    return false if @words_exceptions[lang].include?(word8)


    #шаг 1.
    #проверка на 4 согласные буквы подряд; пример: больши{нств}о, юрисконсу{льтс}тво
    matches = word.match(/(?:#{CONSONANT_LC[lang]}){4}/)
    return true if matches && !CONSONANT4_LC[lang].include?(matches[0])

    #шаг 2.
    #проверка на 3 гласные буквы подряд; пример: длиннош{еее}, зм{еео}бразный
    matches = word.match(/(?:#{VOWEL_LC[lang]}){3}/)
    return true if matches && !VOWELS3_LC[lang].include?(matches[0])



    #шаг 3.
    (length-1).times do |pos|
      ss = word[pos..pos+1]
      ss = ' ' + ss if(pos == 0)
      ss = ss + ' ' if(pos == length-1)
      return true if BIGRAMS.include? ss
    end
    return false
  end
end
